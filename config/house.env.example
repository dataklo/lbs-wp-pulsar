# /etc/pv-tools/house.env
# Konfiguration für house_pulser (ENV Overrides)
# Tipp: Datei nach /etc/pv-tools/house.env kopieren und Werte anpassen.

# --- Grundsätzlich ---
PYTHONUNBUFFERED=1

# --- Modbus / Venus ---
VENUS_IP=192.168.41.101
VENUS_PORT=502
MODBUS_TIMEOUT_S=2.0

# --- Wallbox ein/aus (NEU) ---
# 1/0, true/false, yes/no, on/off
USE_WALLBOX=1

# --- Puls-Parameter ---
# Impulse pro kWh (z.B. 100 Imp/kWh => 10 Wh pro Impuls)
IMP_PER_KWH=100
# optional: Deckelung (alles darüber wird als MAX_NET_POWER_W dargestellt)
MAX_NET_POWER_W=25000

# --- Shelly (Relais, das gepulst wird) ---
SHELLY_IP=192.168.41.124
SHELLY_RELAY_IDX=1
# optional: komplette URL überschreiben (wenn du kein Standard-Schema nutzt)
# SHELLY_ON_URL=http://192.168.41.124/relay/1?turn=on

# Shelly Timing / Robustheit
MIN_TRIGGER_INTERVAL_S=0.080
HTTP_CONNECT_TIMEOUT_S=2.0
HTTP_READ_TIMEOUT_S=2.0
SHELLY_RETRIES=1
RETRY_DELAY_S=0.2

# --- Loop / Logging ---
POLL_INTERVAL_S=0.2
LOG_EVERY_S=5.0
ALPHA_AVG=0.90

# --- Modbus Register / Unit-IDs (nur ändern, wenn deine IDs/Adressen abweichen) ---
# House total consumption (L1/L2/L3) (uint16)
HOUSE_UNIT_ID=100
REG_HOUSE_L1_W=817
REG_HOUSE_L2_W=818
REG_HOUSE_L3_W=819

# Heatpump (uint32: 2 Register)
HP_UNIT_ID=31
REG_HP_POWER_U32=5502
# Wenn HP Werte unsinnig sind: "little" testen
HP_WORDORDER=big

# Wallbox / AC load (L1/L2/L3) (uint16)
CHG_UNIT_ID=52
REG_CHG_L1_W=3900
REG_CHG_L2_W=3901
REG_CHG_L3_W=3902
